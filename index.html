<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Wordle + Homework AI</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family: sans-serif; background: #121212; color: white; text-align: center; padding: 20px; }
h1 { margin-top: 20px; }
.grid { display: grid; grid-template-columns: repeat(5, 60px); gap: 5px; justify-content: center; margin-top: 20px; }
.cell { width: 60px; height: 60px; border: 2px solid #555; display: flex; align-items: center; justify-content: center; font-size: 32px; text-transform: uppercase; }
.green { background-color: #538d4e; color: white; border: 2px solid #538d4e; }
.yellow { background-color: #b59f3b; color: white; border: 2px solid #b59f3b; }
.gray { background-color: #3a3a3c; color: white; border: 2px solid #3a3a3c; }
input { margin-top: 20px; padding: 10px; font-size: 20px; width: 200px; text-transform: lowercase; }
button { margin-left: 10px; padding: 10px; font-size: 18px; cursor: pointer; }

/* Chatbot */
#chat-container { display: none; margin-top: 40px; }
#chat { max-width: 600px; margin: auto; text-align: left; border: 2px solid #555; padding: 10px; height: 300px; overflow-y: auto; }
.user { color: #00f; margin: 5px 0; }
.bot { color: #0f0; margin: 5px 0; }
#chat-msg { width: 70%; padding: 10px; font-size: 16px; }
#chat-send { padding: 10px; font-size: 16px; }
</style>
</head>
<body>

<h1>Wordle Edition</h1>

<div id="grid-container">
  <div class="grid" id="row0"></div>
  <div class="grid" id="row1"></div>
  <div class="grid" id="row2"></div>
  <div class="grid" id="row3"></div>
  <div class="grid" id="row4"></div>
  <div class="grid" id="row5"></div>
</div>

<input type="text" id="guess-input" maxlength="5" placeholder="Enter 5 letters">
<button onclick="submitGuess()">Guess</button>
<p id="message"></p>

<!-- Chatbot -->
<div id="chat-container">
  <h2>Homework Helper AI</h2>
  <div id="chat"></div>
  <input type="text" id="chat-msg" placeholder="Ask a question">
  <button id="chat-send">Send</button>
</div>

<script type="module">
  // --- Wordle Logic ---
  const answer = "penit";
  let currentRow = 0;

  function submitGuess() {
    const guessInput = document.getElementById("guess-input");
    const guess = guessInput.value.toLowerCase();
    if (guess.length !== 5) {
      alert("Enter exactly 5 letters!");
      return;
    }

    const rowDiv = document.getElementById("row" + currentRow);
    rowDiv.innerHTML = "";

    for (let i = 0; i < 5; i++) {
      const cell = document.createElement("div");
      cell.className = "cell";

      if (guess[i] === answer[i]) cell.classList.add("green");
      else if (answer.includes(guess[i])) cell.classList.add("yellow");
      else cell.classList.add("gray");

      cell.textContent = guess[i];
      rowDiv.appendChild(cell);
    }

    currentRow++;
    guessInput.value = "";

    if (guess === answer) {
      document.getElementById("message").textContent = "You won! ðŸŽ‰ Chat with the AI below!";
      document.getElementById("chat-container").style.display = "block";
    } else if (currentRow >= 6) {
      document.getElementById("message").textContent = "Game over! The word was: " + answer.toUpperCase();
      document.getElementById("chat-container").style.display = "block";
    }
  }

  document.getElementById("guess-input").addEventListener("keydown", e => {
    if(e.key === "Enter") submitGuess();
  });

  // --- AI Chatbot ---
  import { WebLLM } from "https://cdn.jsdelivr.net/npm/@mlc-ai/web-llm@0.3.1/dist/web-llm.min.js";

  const llm = new WebLLM({ model: "gpt4all-j", backend: "webgpu" });
  await llm.loadModel();

  const chatDiv = document.getElementById("chat");
  const chatInput = document.getElementById("chat-msg");
  const chatBtn = document.getElementById("chat-send");

  async function sendMessage() {
    const userMsg = chatInput.value.trim();
    if(!userMsg) return;

    const userElem = document.createElement("div");
    userElem.className = "user";
    userElem.textContent = "You: " + userMsg;
    chatDiv.appendChild(userElem);

    chatInput.value = "";
    chatDiv.scrollTop = chatDiv.scrollHeight;

    const aiResponse = await llm.predict(userMsg, { max_new_tokens: 150 });
    const botElem = document.createElement("div");
    botElem.className = "bot";
    botElem.textContent = "AI: " + aiResponse;
    chatDiv.appendChild(botElem);

    chatDiv.scrollTop = chatDiv.scrollHeight;
  }

  chatBtn.addEventListener("click", sendMessage);
  chatInput.addEventListener("keydown", e => { if(e.key==="Enter") sendMessage(); });

</script>

</body>
</html>
